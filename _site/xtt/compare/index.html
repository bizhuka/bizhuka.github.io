<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2709176-10', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><meta data-rh="true" property="al:android:bm_git_app" content="Medium" /><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script> <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> <script> (function() { var d = document, s = d.createElement('script'); s.src = 'https://github-io-17.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> All libraries </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a><nav class="lang-sel"><ul><li class="lang"> <a href="/xtt/compare/" class="enabled">En </a>|<a href="/ru/xtt/compare/"> Ru</a></ul></nav></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/eui/" class="nav-list-link">EUI - user interface</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/eui/zcl_eui_alv/1" class="nav-list-link">ALV manager</a><li class="nav-list-item "><a href="http://localhost:4000/eui/zcl_eui_event_caller/1" class="nav-list-link">EVENT caller</a><li class="nav-list-item "><a href="http://localhost:4000/eui/zcl_eui_file/1" class="nav-list-link">FILE Basic file operations</a><li class="nav-list-item "><a href="http://localhost:4000/eui/zcl_eui_file_io/1" class="nav-list-link">FILE_IO Import/Export to Excel/CSV</a><li class="nav-list-item "><a href="http://localhost:4000/eui/zcl_eui_menu/1" class="nav-list-link">MENU Gos based menu</a><li class="nav-list-item "><a href="http://localhost:4000/eui/zcl_eui_screen/1" class="nav-list-link">SCREEN manager</a><li class="nav-list-item "><a href="http://localhost:4000/eui/zcl_eui_logger/1" class="nav-list-link">Logger</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/xtt/" class="nav-list-link">XTT - reports</a><ul class="nav-list "><li class="nav-list-item active"><a href="http://localhost:4000/xtt/compare/" class="nav-list-link active">Compare with other libraries</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/installation-guide/" class="nav-list-link">Installation guide</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/simple-structure/" class="nav-list-link">010 Simple structure</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/basic-tables/" class="nav-list-link">020 Basic tables</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/excel-formula/" class="nav-list-link">021 Formulas in Excel</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/nested-blocks/" class="nav-list-link">030 Nested blocks</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/data-types/" class="nav-list-link">040 Data types & Excel post processing</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/tree-group-by-fields/" class="nav-list-link">050 Tree (group by fields)</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/tree-output-level-by-condition/" class="nav-list-link">051 Output level by condition</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/tree-aggregation-functions/" class="nav-list-link">052 Aggregation functions</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/tree-group-by-field-relations/" class="nav-list-link">060 Tree (group by field relations)</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/macro/" class="nav-list-link">070 Macro call & prepare_raw event</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/output-direction/" class="nav-list-link">080 ;direction=column addition</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/dynamic-table/" class="nav-list-link">090 Dynamic table (tree)</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/images/" class="nav-list-link">100 Images</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/images-no-code/" class="nav-list-link">110 Images ';type=image'</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/class-attributes/" class="nav-list-link">120 Class attributes</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/cond/" class="nav-list-link">130 Addition ';cond='</a><li class="nav-list-item "><a href="http://localhost:4000/xtt/block/" class="nav-list-link">140 Blocks by condition</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/aqo/" class="nav-list-link">AQO - options</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/aqo/se38-zaqo_test/" class="nav-list-link">Structure based options</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/se24-zcl_aqo_tester/" class="nav-list-link">Class based options</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/installation-guide/" class="nav-list-link">Installation guide</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/field-catalog/" class="nav-list-link">Field catalog and other table settings</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/which-transaction-to-choose/" class="nav-list-link">01 Which transaction to choose</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/search-abap-code/" class="nav-list-link">02 Search abap code</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/extensions/" class="nav-list-link">03 Extensions</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/complex-data-types/" class="nav-list-link">04 Complex data types</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/export-and-import-data/" class="nav-list-link">05 Export and import data</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/create-option-via-interface/" class="nav-list-link">06 Create option via interface</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/search-help-in-ui5/" class="nav-list-link">07 Search help in ui5</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/changing-fields-descriptions/" class="nav-list-link">08 Changing fields descriptions</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/interface-description/" class="nav-list-link">09 Interface description</a><li class="nav-list-item "><a href="http://localhost:4000/aqo/oaor/" class="nav-list-link">10 OAOR</a></ul></ul></nav><footer class="site-footer"><section id="lab_social_icon_footer" class="text-small text-grey-dk-000 mb-0"><div class="container"><div class="center-block"> <a href="mailto:modekz@gmail.com"><i id="social-em" class="fa fa-envelope-square social fa-2x"></i></a> <a href="https://t.me/modekz"><i id="social-tg" class="fa fa-telegram social fa-2x" ></i></a> <a href="https://github.com/bizhuka"><i id="social-gh" class="fa fa-github-square social fa-2x"></i></a></div></div></section></footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search All libraries" aria-label="Search All libraries" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/bizhuka/" class="site-button" > on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/xtt/">XTT - reports</a><li class="breadcrumb-nav-list-item"><span>Compare with other libraries</span></ol></nav><div id="main-content" class="main-content" role="main"><nav id="nav-sidebar" class="hidden-print hidden-xs hidden-sm affix bs-docs-sidebar"><ul id="sidebar" class="nav nav-stacked"><li class="toc_li"><a href="#xtt---xml-template-toolkit"><strong>XTT</strong> - Xml template toolkit</a><li class="toc_li"><a href="#directives">Directives</a><li class="toc_li"><a href="#1-directives-for-one-value">1) Directives for one value</a><li class="toc_li"><a href="#1-1-type-data-type">1-1) ‘;type=’ Data type</a><li class="toc_li"><a href="#1-2-cond-conditional-output">1-2) ‘;cond=’ Conditional output</a><li class="toc_li"><a href="#1-3-func-built-in-functions">1-3) ‘;func=’ Built-in functions</a><li class="toc_li"><a href="#2-clarification-for-a-table-or-tree">2) Clarification for a table or tree</a><li class="toc_li"><a href="#2-1-directioncolumn">2-1) ‘;direction=column’</a><li class="toc_li"><a href="#2-1-group">2-1) ‘;group=’</a><li class="toc_li"><a href="#3-blocks-directives">3) Block’s directives</a><li class="toc_li"><a href="#3-1-typeblock-conditional-block">3-1) ‘;type=block’ Conditional block</a><li class="toc_li"><a href="#3-2-tree-output-directives">3-2) Tree output directives</a></ul></nav><article><h3 class="no_toc" id="mustachioed-template-engine"> <a href="#mustachioed-template-engine" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mustachioed template engine</h3><p>   Most modern template engines in the web (and also in ABAP) work according to one simple principle. <br /> <strong>Data + Template = Ready document</strong> <br /> So how is <strong>XTT</strong> different from its peers?</p><p><img src="https://user-images.githubusercontent.com/36256417/81717603-31374d80-9494-11ea-9b6f-7e20d85f7752.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><p>   Without diminishing the merits of more popular report generation libraries, let’s compare XTT with the main ones:<br /></p><ul><li><a href="https://sites.google.com/site/sapxlwb/home/rus">XLSX Workbench</a> uses a special <strong>editor</strong> to customize the template</ul><p><img src="https://user-images.githubusercontent.com/36256417/81719472-8e340300-9496-11ea-816e-90e04bb0c7a0.png" alt="image" /></p><p><br /> <br /> <br /></p><ul><li><a href="https://github.com/sapmentors/abap2xlsx">abap2xlsx</a> uses <strong>ZCL_EXCEL_READER_2007</strong> class to read a template</ul><p><img src="https://user-images.githubusercontent.com/36256417/81720186-7dd05800-9497-11ea-9911-899d3e6ab904.png" alt="image" /></p><p><br /> <br /> <br /></p><ul><li><a href="https://sapboard.ru/forum/viewtopic.php?f=13&amp;t=4880&amp;sid=12bc45858aa39ac048f08509efa5d5eb">ZWWW</a> uses the familiar <strong>WYSIWYG</strong> MS Excel or Word editor. <br /> Bookmarks are also needed in Word (2 previous ones specialize in Excel format)</ul><p><img src="https://user-images.githubusercontent.com/36256417/81720960-8aa17b80-9498-11ea-80dc-4a4df507d4d7.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><h3 id="xtt---xml-template-toolkit"> <a href="#xtt---xml-template-toolkit" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>XTT</strong> - Xml template toolkit</h3><p>   This opus is more like the latest development and maximizes the capabilities of the WYSIWYG editor itself.<br /> For data transfer, as in the XLSX Workbench, the concept of context is used.</p><p>   All you need to do to combine the data with the template is to call the <strong>MERGE</strong> method<br /> Context <strong>IS_BLOCK</strong> (usually an ABAP structure) matches the structure of the document.<br /> The root label (usually ‘<strong>R</strong>’) is an optional parameter and is most likely needed if the data is combined with the template several times.</p><p><img src="https://user-images.githubusercontent.com/36256417/81728962-af9beb80-94a4-11ea-88b8-5aa6966c4e82.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><p>   Since the MERGE signature is as simple as possible, the main difficulty can arise with the template itself</p><p><img src="https://user-images.githubusercontent.com/36256417/81731141-fb03c900-94a7-11ea-9528-01423c219b3e.png" alt="image" /></p><p><br /> <br /> <br /></p><p>I hope, due to its obviousness, in most cases the study of <strong>{mustachioed syntax}</strong> is not required at all.<br /> The structure of the document will look approximately the same everywhere.</p><div class="language-abap highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">" Document structure</span>
    <span class="k">BEGIN</span> <span class="k">OF</span> <span class="n">ts_root</span><span class="p">,</span>
      <span class="k">header</span>   <span class="k">TYPE</span> <span class="k">string</span><span class="p">,</span>
      <span class="kt">t</span>        <span class="k">TYPE</span> <span class="n">tt_rand_data</span><span class="p">,</span> <span class="c1">" internal flat table ( In template {R-T} )</span>
      <span class="k">date</span>     <span class="k">TYPE</span> <span class="kt">d</span><span class="p">,</span>            <span class="c1">" 8</span>
      <span class="n">datetime</span> <span class="k">TYPE</span> <span class="n">char14</span><span class="p">,</span>       <span class="c1">" date(8) + time(6)</span>
    <span class="k">END</span> <span class="k">OF</span> <span class="n">ts_root</span><span class="p">.</span>
</code></pre></div></div><h3 class="no_toc" id="ms-excel"> <a href="#ms-excel" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS Excel</h3><p><img src="https://user-images.githubusercontent.com/36256417/81732894-985ffc80-94aa-11ea-8a8d-7206a7562d44.png" alt="image" /></p><h3 class="no_toc" id="ms-word"> <a href="#ms-word" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS Word</h3><p><img src="https://user-images.githubusercontent.com/36256417/81733163-fdb3ed80-94aa-11ea-93a9-c8cc8a629736.png" alt="image" /></p><h3 class="no_toc" id="adobe-livecycle"> <a href="#adobe-livecycle" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adobe LiveCycle</h3><p><img src="https://user-images.githubusercontent.com/36256417/81733595-b4b06900-94ab-11ea-9c92-688414b59c56.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><h3 id="directives"> <a href="#directives" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Directives</h3><p>   All special features (directives) are always inside <strong>{curly braces}</strong><br /> They, quite conditionally, can be divided into 3 main groups:</p><ul><li>1) Related to one value<li>2) Clarification for the entire table or tree<li>3) Block’s directives</ul><p>Let’s look at each of them individually:</p><hr /><p><br /></p><h3 id="1-directives-for-one-value"> <a href="#1-directives-for-one-value" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1) Directives for one value</h3><h3 id="1-1-type-data-type"> <a href="#1-1-type-data-type" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-1) ‘;type=’ Data type</h3><p>   The first part of them relates to the clarification of <a href="../data-types">data type {;type=}</a><br /> In general, it is advisable to leave the type as is without converting to others.<br /></p><ul><li><p>If the report contains numbers, then they do not need to be converted to strings. If you need to output an empty cell instead of 0, it is easier to use a change in the format itself.<br /> <strong>Ctrl+1</strong> - &gt; Custom -&gt; <strong>0;-0;;@</strong></p><li><p>For dates, conversion to strings is also not advisable. If the report displays a number like <strong>43964</strong> instead of the date, just change the format of the cell itself to the date</p></ul><p>But there are exceptions:</p><ul><li><p><strong>{;type=boolean}</strong> &amp; <strong>{;type=datetime}</strong> since they are not in the ABAP language itself</p><li><p><strong>{;type=mask}</strong> if you need an analog of <code class="language-plaintext highlighter-rouge">WRITE TO</code> (for example WBS element)</p><li><p><strong>{;type=integer}</strong> to convert from type <strong>CHAR</strong> <br /> If you are 100% sure that only numbers will be in the characters (but even in this case it is advisable to declare the type as <strong>NUMC</strong> for the report)</p></ul><p>With (BTRTL) and without(WERKS) type specification</p><p><img src="https://user-images.githubusercontent.com/36256417/81779925-1229d180-950f-11ea-80e9-ea63550de2ec.png" alt="image" /></p><p>Result</p><p><img src="https://user-images.githubusercontent.com/36256417/81778016-72b70f80-950b-11ea-912b-56e26769d6ba.png" alt="image" /></p><p><br /> <br /> <br /></p><h3 id="1-2-cond-conditional-output"> <a href="#1-2-cond-conditional-output" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-2) ‘;cond=’ Conditional output</h3><p>    <a href="../cond/">‘;cond=’</a> addition allows you to write a simple condition for displaying one or the other value using String Templates or any other ABAP operator (SWITCH, COND, VALUE) that returns only <em>one resulting value</em></p><h3 id="1-3-func-built-in-functions"> <a href="#1-3-func-built-in-functions" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-3) ‘;func=’ Built-in functions</h3><p>   The another part is related to aggregation functions <a href="../tree-aggregation-functions/">;func= SUM | AVG | COUNT | FIRST</a> which work in conjunction with <a href="../compare/#3-2-tree-output-directives">3-2) tree output directives</a>. <br /> For more complex cases there is a special event in ABAP</p><p>For simple totals in Excel, you can use standard tools</p><p><img src="https://user-images.githubusercontent.com/36256417/81732894-985ffc80-94aa-11ea-8a8d-7206a7562d44.png" alt="image" /></p><p>But if you need a universal method that works in Word and Pdf, you can use these functions</p><p><img src="https://user-images.githubusercontent.com/36256417/81783258-8450e500-9514-11ea-86ab-1e12cc05cc36.png" alt="image" /></p><hr /><p><br /></p><h3 id="2-clarification-for-a-table-or-tree"> <a href="#2-clarification-for-a-table-or-tree" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2) Clarification for a table or tree</h3><p>    Unlike previous directives that were directly in the cell itself, this kind of directives can be placed anywhere in the template and works for entire table or tree</p><h3 id="2-1-directioncolumn"> <a href="#2-1-directioncolumn" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-1) ‘;direction=column’</h3><p><a href="../output-direction/">{;direction=column}</a> works only for in the <code class="language-plaintext highlighter-rouge">ZCL_XTT_EXCEL_XLSX</code> class and specifies how to display the table. By default, tables and trees are displayed row by row.</p><p><img src="https://raw.githubusercontent.com/wiki/bizhuka/xtt/img/dir_column_01.png" alt="" /></p><p>   If you need a dynamic table that expands row by row, and column by column please look at <a href="../dynamic-table/">this example</a></p><h3 id="2-1-group"> <a href="#2-1-group" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-1) ‘;group=’</h3><p> Allows you to group tabular data in a hierarchical structure similar to a <strong>tree</strong>. <br />  To convert a table to a tree, you can use ABAP methods zcl_xtt_replace_block=&gt;<a href="../tree-group-by-fields/">tree_create</a> or zcl_xtt_replace_block=&gt;<a href="../tree-group-by-field-relations/">tree_create_relat</a>. <br />  But making such a group declaration in the template itself allows you to give a clear picture of the fact that the table has been transformed into a tree.<br /></p><ul><li><p>Instead tree_create =&gt; {;group=<em>Comma-separated table fields</em>}.<br /> For subtotals with BUKRS <strong>{R-T;group=BUKRS}</strong></p><li><p>Instead tree_create_relat =&gt; {;group=<em>Fields Parent-subsidiary through dash</em>}<br /> For tree org units by IT 1001 <strong>{R-T;group=OBJID-SOBID}</strong></p></ul><p> In the simplest case, you need to create simple subtotals,<br /> <strong>level=0</strong> (overall totals) in which there is <strong>level=1</strong> with the data of the table itself</p><p><img src="https://user-images.githubusercontent.com/36256417/81783258-8450e500-9514-11ea-86ab-1e12cc05cc36.png" alt="image" /></p><p><br /></p><p> If we need subtotal on BUKRS <strong>{;group=BUKRS}</strong> we get 3 levels (0,1,2)<br /> <strong>level=0</strong> Total for all BUKRSs<br /> <strong>level=1</strong> Total for 1 BUKRS<br /> <strong>level=2</strong> Table data</p><p>In the <code class="language-plaintext highlighter-rouge">ZCL_XTT_EXCEL_XLSX</code> class, the declaration of a tree at the sheet level makes it possible to display the same table on different sheets with different groupings</p><p><a href="../tree-group-by-fields/">In this</a> example, the table {R-T} is displayed differently depending on the declaration on a particular sheet</p><p><img src="https://user-images.githubusercontent.com/36256417/81787378-60909d80-951a-11ea-9e94-36ae3666bd75.png" alt="image" /></p><p><br /></p><hr /><p><br /></p><h3 id="3-blocks-directives"> <a href="#3-blocks-directives" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3) Block’s directives</h3><h3 id="3-1-typeblock-conditional-block"> <a href="#3-1-typeblock-conditional-block" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3-1) ‘;type=block’ Conditional block</h3><p><a href="../block/">‘;type=block;’</a> addition together with <em>‘;cond=’</em> addition is intended for conditional output of the one block.</p><p>That is, it works similarly to ‘show_if’ for a tree. But it is intended for one-time execution only. ‘show_if’ works for each table row and their subtotals at different levels</p><h3 id="3-2-tree-output-directives"> <a href="#3-2-tree-output-directives" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3-2) Tree output directives</h3><p> After the table has been converted to a tree, you can set the boundaries and output conditions of each level.<br /></p><ul><li><strong>;level=</strong> Specifies for which level this row (column) is intended<li><strong>;top=X</strong> It says that the withdrawal will be carried out <strong>before</strong> a lower level (empty or ;top= that <strong>after</strong> a lower level)<li><strong>;show_if=</strong> &amp; <strong>;hide_if=</strong> allow you to specify the output condition of a particular level <br /> The condition is written in ABAP and has a special reserved name <strong>row</strong> to refer to the current row in the tree</ul><p>This example is grouped by 1 field</p><p><img src="https://user-images.githubusercontent.com/36256417/81786911-b87ad480-9519-11ea-8e2f-2c30964b3631.png" alt="image" /></p><p>Result</p><p><img src="https://user-images.githubusercontent.com/36256417/81808568-529e4500-9539-11ea-9523-e273681d3974.png" alt="image" /></p><p> More about directives <a href="../tree-output-level-by-condition/">level, top, show_if, hide_if</a></p></article><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/bizhuka/bizhuka.github.io/tree/master/docs/xtt/00-compare.md" id="edit-this-page">Page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div><div id="disqus_thread"></div></div>
