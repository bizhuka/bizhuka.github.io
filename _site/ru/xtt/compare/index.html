<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="http://localhost:4000/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="http://localhost:4000/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2709176-10', { 'anonymize_ip': true }); </script> <script type="text/javascript" src="http://localhost:4000/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="http://localhost:4000/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><meta data-rh="true" property="al:android:bm_git_app" content="Medium" /><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script> <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.3.0/bootbox.min.js"></script> <script> $(function() { $('[data-bootbox]').off('click').on('click', function() { var $target = $('#' + $(this).data('bootbox')); bootbox.alert({ title: $target.attr('title'), message: $target.html(), size: $(this).data('bootbox-size') }); }); }); </script> <script> (function() { var d = document, s = d.createElement('script'); s.src = 'https://github-io-17.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> All libraries </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a><nav class="lang-sel"><ul><li class="lang"> <a href="/xtt/compare/">En </a>|<a href="/ru/xtt/compare/" class="enabled"> Ru</a></ul></nav></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/ru/" class="nav-list-link">Домой</a><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/ru/eui/" class="nav-list-link">EUI - интерфейс пользователя</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/ru/eui/zcl_eui_alv/1" class="nav-list-link">ALV менеджер</a><li class="nav-list-item "><a href="http://localhost:4000/ru/eui/zcl_eui_event_caller/1" class="nav-list-link">EVENT вызыв события</a><li class="nav-list-item "><a href="http://localhost:4000/ru/eui/zcl_eui_file/1" class="nav-list-link">FILE Основные файловые операции</a><li class="nav-list-item "><a href="http://localhost:4000/ru/eui/zcl_eui_file_io/1" class="nav-list-link">FILE_IO Импорт/Экспорт в Excel/CSV</a><li class="nav-list-item "><a href="http://localhost:4000/ru/eui/zcl_eui_menu/1" class="nav-list-link">MENU Gos меню</a><li class="nav-list-item "><a href="http://localhost:4000/ru/eui/zcl_eui_screen/1" class="nav-list-link">SCREEN Менеджер экранов</a><li class="nav-list-item "><a href="http://localhost:4000/ru/eui/zcl_eui_logger/1" class="nav-list-link">Журнал приложений</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/ru/xtt/" class="nav-list-link">XTT - отчеты</a><ul class="nav-list "><li class="nav-list-item active"><a href="http://localhost:4000/ru/xtt/compare/" class="nav-list-link active">Сравните с другими библиотеками</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/installation-guide/" class="nav-list-link">Инструкция по установке</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/simple-structure/" class="nav-list-link">010 Вывод простой структуры</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/basic-tables/" class="nav-list-link">020 Вывод простой таблицы</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/excel-formula/" class="nav-list-link">021 Формулы в Excel</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/nested-blocks/" class="nav-list-link">030 Вложенные блоки</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/data-types/" class="nav-list-link">040 Типы данных и пост обработка Excel</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/tree-group-by-fields/" class="nav-list-link">050 Деревья (группировка по полям)</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/tree-output-level-by-condition/" class="nav-list-link">051 Вывод уровня по условию</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/tree-aggregation-functions/" class="nav-list-link">052 Функции агрегации</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/tree-group-by-field-relations/" class="nav-list-link">060 Деревья (на основе связи родитель дочерний)</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/macro/" class="nav-list-link">070 Вызов макроса и событие prepare_raw</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/output-direction/" class="nav-list-link">080 Дополнение ;direction=column</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/dynamic-table/" class="nav-list-link">090 Динамическая таблица (дерево)</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/images/" class="nav-list-link">100 Изображения</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/images-no-code/" class="nav-list-link">110 Изображения ';type=image'</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/class-attributes/" class="nav-list-link">120 Атрибуты класса</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/cond/" class="nav-list-link">130 Дополнение ';cond='</a><li class="nav-list-item "><a href="http://localhost:4000/ru/xtt/block/" class="nav-list-link">140 Блоки по условию</a></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/ru/aqo/" class="nav-list-link">AQO - настройки</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/se38-zaqo_test/" class="nav-list-link">Настройки на основе структуры</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/se24-zcl_aqo_tester/" class="nav-list-link">Настройки на основе класса</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/field-catalog/" class="nav-list-link">Каталог полей и прочие настройки таблиц</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/installation-guide/" class="nav-list-link">Инструкция по установке</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/which-transaction-to-choose/" class="nav-list-link">01 Какую транзакцию выбрать</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/search-abap-code/" class="nav-list-link">02 Поиск кода с настройкой</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/extensions/" class="nav-list-link">03 Расширение</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/complex-data-types/" class="nav-list-link">04 Сложные типы данных</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/export-and-import-data/" class="nav-list-link">05 Экспорт и импорт данных</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/create-option-via-interface/" class="nav-list-link">06 Создание настройки через интерфейс</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/search-help-in-ui5/" class="nav-list-link">07 Средство поиска в ui5</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/changing-fields-descriptions/" class="nav-list-link">08 Изменение описания полей</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/interface-description/" class="nav-list-link">09 Описание интерфейса</a><li class="nav-list-item "><a href="http://localhost:4000/ru/aqo/oaor/" class="nav-list-link">10 OAOR</a></ul></ul></nav><footer class="site-footer"><section id="lab_social_icon_footer" class="text-small text-grey-dk-000 mb-0"><div class="container"><div class="center-block"> <a href="mailto:modekz@gmail.com"><i id="social-em" class="fa fa-envelope-square social fa-2x"></i></a> <a href="https://t.me/modekz"><i id="social-tg" class="fa fa-telegram social fa-2x" ></i></a> <a href="https://github.com/bizhuka"><i id="social-gh" class="fa fa-github-square social fa-2x"></i></a></div></div></section></footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search All libraries" aria-label="Search All libraries" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/bizhuka/" class="site-button" > on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/ru/xtt/">XTT - отчеты</a><li class="breadcrumb-nav-list-item"><span>Сравните с другими библиотеками</span></ol></nav><div id="main-content" class="main-content" role="main"><nav id="nav-sidebar" class="hidden-print hidden-xs hidden-sm affix bs-docs-sidebar"><ul id="sidebar" class="nav nav-stacked"><li class="toc_li"><a href="#xtt---xml-template-toolkit"><strong>XTT</strong> - Xml template toolkit</a><li class="toc_li"><a href="#директивы">Директивы</a><li class="toc_li"><a href="#1-директивы-вывода-1-го-значения">1) Директивы вывода 1-го значения</a><li class="toc_li"><a href="#1-1-type-тип-данных">1-1) ‘;type=’ Тип данных</a><li class="toc_li"><a href="#1-2-cond-условный-вывод">1-2) ‘;cond=’ Условный вывод</a><li class="toc_li"><a href="#1-3-func-встроенные-функции">1-3) ‘;func=’ Встроенные функции</a><li class="toc_li"><a href="#2-уточнения-таблицы-или-дерева">2) Уточнения таблицы или дерева</a><li class="toc_li"><a href="#2-1-directioncolumn">2-1) ‘;direction=column’</a><li class="toc_li"><a href="#2-2-group">2-2) ‘;group=’</a><li class="toc_li"><a href="#3-блочные-директивы">3) Блочные директивы</a><li class="toc_li"><a href="#3-1-typeblock-блок-по-условию">3-1) ‘;type=block’ Блок по условию</a><li class="toc_li"><a href="#3-2-директивы-вывода-дерева">3-2) Директивы вывода дерева</a></ul></nav><article><h3 class="no_toc" id="усатый-шаблонизатор"> <a href="#усатый-шаблонизатор" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Усатый шаблонизатор</h3><p>   Большинство современных шаблонизаторов в web (и также в ABAP) работают по одному простому принципу<br /><br /> <strong>Данные + Шаблон = Готовый документ</strong><br /> Так чем отличается <strong>XTT</strong> от своих аналогов?</p><p><img src="https://user-images.githubusercontent.com/36256417/81717603-31374d80-9494-11ea-9b6f-7e20d85f7752.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><p>   Нисколько не умаляя достоинства более популярных библиотек для генерации отчетов, давайте сравним XTT c основными из них:<br /></p><ul><li><a href="https://sites.google.com/site/sapxlwb/home/rus">XLSX Workbench</a> использует специальный <strong>редактор</strong> для настройки шаблона</ul><p><img src="https://user-images.githubusercontent.com/36256417/81719472-8e340300-9496-11ea-816e-90e04bb0c7a0.png" alt="image" /></p><p><br /> <br /> <br /></p><ul><li><a href="https://github.com/sapmentors/abap2xlsx">abap2xlsx</a> использует класс <strong>ZCL_EXCEL_READER_2007</strong> для считывания шаблона</ul><p><img src="https://user-images.githubusercontent.com/36256417/81720186-7dd05800-9497-11ea-9911-899d3e6ab904.png" alt="image" /></p><p><br /> <br /> <br /></p><ul><li><a href="https://sapboard.ru/forum/viewtopic.php?f=13&amp;t=4880&amp;sid=12bc45858aa39ac048f08509efa5d5eb">ZWWW</a> использует привычный <strong>WYSIWYG</strong> MS Excel или Word редактор.<br /> В ворде также нужны закладки (2 предыдущих специализируются на формате Excel)</ul><p><img src="https://user-images.githubusercontent.com/36256417/81720960-8aa17b80-9498-11ea-80dc-4a4df507d4d7.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><h3 id="xtt---xml-template-toolkit"> <a href="#xtt---xml-template-toolkit" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>XTT</strong> - Xml template toolkit</h3><p>   Данный опус в большей степени походит на последнюю разработку и максимально использует возможности самого WYSIWYG редактора.<br /> Для передачи данных также как и в XLSX Workbench используется понятие контекста</p><p>   Все что нужно сделать чтобы объединить данные с шаблоном это вызвать метод <strong>MERGE</strong><br /> Контекст <strong>IS_BLOCK</strong> (обычно ABAP структура) соответствует структуре документа.<br /> Корневая метка (обычно ‘<strong>R</strong>’) является опциональным параметром и скорее нужна если данные объединяются с шаблоном несколько раз.</p><p><img src="https://user-images.githubusercontent.com/36256417/81728962-af9beb80-94a4-11ea-88b8-5aa6966c4e82.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><p>   Так как сигнатура MERGE максимальна проста, основная сложность может возникнуть с самим шаблоном</p><p><img src="https://user-images.githubusercontent.com/36256417/81731141-fb03c900-94a7-11ea-9528-01423c219b3e.png" alt="image" /></p><p><br /> <br /> <br /></p><p>Надеюсь, по причине своей очевидности, в большинстве случаев изучение <strong>{усатого синтаксиса}</strong> не потребуется.<br /> Структура документа везде будет выглядеть приблизительно одинаково</p><div class="language-abap highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">" Document structure</span>
    <span class="k">BEGIN</span> <span class="k">OF</span> <span class="n">ts_root</span><span class="p">,</span>
      <span class="k">header</span>   <span class="k">TYPE</span> <span class="k">string</span><span class="p">,</span>
      <span class="kt">t</span>        <span class="k">TYPE</span> <span class="n">tt_rand_data</span><span class="p">,</span> <span class="c1">" internal flat table ( In template {R-T} )</span>
      <span class="k">date</span>     <span class="k">TYPE</span> <span class="kt">d</span><span class="p">,</span>            <span class="c1">" 8</span>
      <span class="n">datetime</span> <span class="k">TYPE</span> <span class="n">char14</span><span class="p">,</span>       <span class="c1">" date(8) + time(6)</span>
    <span class="k">END</span> <span class="k">OF</span> <span class="n">ts_root</span><span class="p">.</span>
</code></pre></div></div><h3 class="no_toc" id="ms-excel"> <a href="#ms-excel" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS Excel</h3><p><img src="https://user-images.githubusercontent.com/36256417/81732894-985ffc80-94aa-11ea-8a8d-7206a7562d44.png" alt="image" /></p><h3 class="no_toc" id="ms-word"> <a href="#ms-word" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS Word</h3><p><img src="https://user-images.githubusercontent.com/36256417/81733163-fdb3ed80-94aa-11ea-93a9-c8cc8a629736.png" alt="image" /></p><h3 class="no_toc" id="adobe-livecycle"> <a href="#adobe-livecycle" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adobe LiveCycle</h3><p><img src="https://user-images.githubusercontent.com/36256417/81733595-b4b06900-94ab-11ea-9c92-688414b59c56.png" alt="image" /></p><p><br /> <br /> <br /></p><hr /><h3 id="директивы"> <a href="#директивы" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Директивы</h3><p>   Все специальные возможности (директивы) всегда указываются <strong>{внутри фигурных скобок}</strong><br /> Их, весьма условно, можно разделить на 3 основных группы:</p><ul><li>1) Относящиеся к выводу 1-го значения<li>2) Уточнение для всей таблицы или дерева<li>3) Блочные директивы</ul><p>Давайте рассмотрим каждое из них по отдельности:</p><hr /><p><br /></p><h3 id="1-директивы-вывода-1-го-значения"> <a href="#1-директивы-вывода-1-го-значения" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1) Директивы вывода 1-го значения</h3><h3 id="1-1-type-тип-данных"> <a href="#1-1-type-тип-данных" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-1) ‘;type=’ Тип данных</h3><p>   Первая часть из них относится к уточнению <a href="../data-types">типа данных {;type=}</a><br /> В общем случае, желательно оставлять тип как есть, не преобразуя в другие.<br /></p><ul><li><p>Если в отчете есть числа, то их не надо преобразовывать в строки. Если надо вывести пусто вместо 0, проще воспользоваться изменением самого формата.<br /> <strong>Ctrl+1</strong> - &gt; Специальный формат -&gt; <strong>0;-0;;@</strong></p><li><p>Для дат преобразование в строки также не желательно. Если в отчете вышло число вроде <strong>43964</strong> вместо даты, просто измените формат самой ячейки на дату</p></ul><p>Но есть и исключения:</p><ul><li><p><strong>{;type=boolean}</strong> и <strong>{;type=datetime}</strong> тк их по сути нет в самом языке ABAP</p><li><p><strong>{;type=mask}</strong> если нужен аналог <code class="language-plaintext highlighter-rouge">WRITE TO</code> (к примеру СПП элемент)</p><li><p><strong>{;type=integer}</strong> чтобы преобразовать из типа <strong>CHAR</strong> <br /> Если вы уверены на все 100% что в символах будут только числа (но и в этом случае желательно объявить тип как <strong>NUMC</strong> для отчета)</p></ul><p>С уточнением типа (BTRTL) и без него (WERKS)</p><p><img src="https://user-images.githubusercontent.com/36256417/81779925-1229d180-950f-11ea-80e9-ea63550de2ec.png" alt="image" /></p><p>Результат</p><p><img src="https://user-images.githubusercontent.com/36256417/81778016-72b70f80-950b-11ea-912b-56e26769d6ba.png" alt="image" /></p><p><br /> <br /> <br /></p><h3 id="1-2-cond-условный-вывод"> <a href="#1-2-cond-условный-вывод" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-2) ‘;cond=’ Условный вывод</h3><p>    Дополнение <a href="../cond/">‘;cond=’</a> позволяет написать простое условие для вывода 1-го или другого значения с использованием String Templates или любого другого оператора ABAP (SWITCH, COND, VALUE) который возвращает лишь <em>одно результирующее значение</em></p><h3 id="1-3-func-встроенные-функции"> <a href="#1-3-func-встроенные-функции" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1-3) ‘;func=’ Встроенные функции</h3><p>   Другая часть связана с функциями агрегации <a href="../tree-aggregation-functions/">;func= SUM | AVG | COUNT | FIRST</a> которые работают совместно с <a href="../compare/#3-2-%D0%B4%D0%B8%D1%80%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D1%8B-%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D0%B0-%D0%B4%D0%B5%D1%80%D0%B5%D0%B2%D0%B0">3-2) директивами вывода дерева</a>. <br /></p><p>Для более сложных случаев есть специальное событие в ABAP</p><p>Для простых итогов в Excel можно воспользоваться стандартными средствами</p><p><img src="https://user-images.githubusercontent.com/36256417/81732894-985ffc80-94aa-11ea-8a8d-7206a7562d44.png" alt="image" /></p><p>Но если нужен универсальный способ который работает в Word и Pdf можно воспользоваться данными функциями</p><p><img src="https://user-images.githubusercontent.com/36256417/81783258-8450e500-9514-11ea-86ab-1e12cc05cc36.png" alt="image" /></p><hr /><p><br /></p><h3 id="2-уточнения-таблицы-или-дерева"> <a href="#2-уточнения-таблицы-или-дерева" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2) Уточнения таблицы или дерева</h3><p>    В отличии от предыдущих директив которые находились непосредственно в самой ячейке, данный вид директив можно располагать в любом месте шаблона и они относится ко всей таблице или дереву целиком</p><h3 id="2-1-directioncolumn"> <a href="#2-1-directioncolumn" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-1) ‘;direction=column’</h3><p><a href="../output-direction/">{;direction=column}</a> работает только в классе <code class="language-plaintext highlighter-rouge">ZCL_XTT_EXCEL_XLSX</code> и уточняет как нужно вывести таблицу. По умолчанию таблицы и деревья выводятся по строкам.</p><p><img src="https://raw.githubusercontent.com/wiki/bizhuka/xtt/img/dir_column_01.png" alt="" /></p><p>   Если вам нужна динамическая таблица которая расширяется как по строкам, так и по столбцам посмотрите пожалуйста на <a href="../dynamic-table/">данный пример</a></p><h3 id="2-2-group"> <a href="#2-2-group" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2-2) ‘;group=’</h3><p> Позволяет сгруппировать табличные данные в иерархическую структуру на подобие <strong>дерева</strong>. <br />  Для преобразования таблицы в дерево можно воспользоваться и двумя программными методами zcl_xtt_replace_block=&gt;<a href="../tree-group-by-fields/">tree_create</a> и zcl_xtt_replace_block=&gt;<a href="../tree-group-by-field-relations/">tree_create_relat</a>. <br />  Но сделав подобное объявление группы в самом шаблоне, позволяет дать ясную картину того что таблица была трансформирована в дерево.<br /></p><ul><li><p>Вместо tree_create =&gt; {;group=<em>Поля таблицы через запятую</em>}.<br /> Для подитогов с БЕ <strong>{R-T;group=BUKRS}</strong></p><li><p>Вместо tree_create_relat =&gt; {;group=<em>Поля РОДИТЕЛЬ-ДОЧЕРНИЙ через тире</em>}<br /> Для дерева орг единиц по ИТ 1001 <strong>{R-T;group=OBJID-SOBID}</strong></p></ul><p> В самом простом случае нужно создать простые подитоги,<br /> <strong>level=0</strong> (итого по всем) в котором есть <strong>level=1</strong> c данными самой таблицы</p><p><img src="https://user-images.githubusercontent.com/36256417/81783258-8450e500-9514-11ea-86ab-1e12cc05cc36.png" alt="image" /></p><p><br /></p><p> Если нам нужны подитоги по БЕ <strong>{;group=BUKRS}</strong> у нас получится 3 уровня (0,1,2)<br /> <strong>level=0</strong> Итого по всем БЕ<br /> <strong>level=1</strong> Итого по 1-й БЕ<br /> <strong>level=2</strong> Данные таблицы</p><p>В классе <code class="language-plaintext highlighter-rouge">ZCL_XTT_EXCEL_XLSX</code> объявление дерева на уровне страницы дает возможность вывода одной и той же таблицы на разных листах с разными группировками</p><p><a href="../tree-group-by-fields/">В данном</a> примере таблица {R-T} выводится по разному в зависимости от объявления на конкретном листе</p><p><img src="https://user-images.githubusercontent.com/36256417/81787378-60909d80-951a-11ea-9e94-36ae3666bd75.png" alt="image" /></p><p><br /></p><hr /><p><br /></p><h3 id="3-блочные-директивы"> <a href="#3-блочные-директивы" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3) Блочные директивы</h3><h3 id="3-1-typeblock-блок-по-условию"> <a href="#3-1-typeblock-блок-по-условию" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3-1) ‘;type=block’ Блок по условию</h3><p>Дополнение <a href="../block/">‘;type=block;’</a> совместно с дополнение <em>‘;cond=’</em> предназначено для условного вывода 1-го блока.</p><p>То есть оно работает аналогично ‘show_if’ для дерева. Но предназначено лишь для однократного выполнения. ‘show_if’ работает для каждой строки таблицы и их подитогов на разных уровнях</p><h3 id="3-2-директивы-вывода-дерева"> <a href="#3-2-директивы-вывода-дерева" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3-2) Директивы вывода дерева</h3><p> После того как таблица была преобразована в дерево, можно задать границы и условия вывода каждого уровня.<br /></p><ul><li><strong>;level=</strong> Уточняет для какого уровня предназначена данная строка (столбец)<li><strong>;top=X</strong> Говорит о том что вывод будет осуществлен <strong>до</strong> нижестоящего уровня (пусто или <strong>‘;top=’</strong> что <strong>после</strong>)<li><strong>;show_if=</strong> и <strong>;hide_if=</strong> позволяют указать условие вывода того или иного уровня <br /> Условие пишется на языке ABAP и имеет специальное зарезервированное имя <strong>row</strong> для ссылки на текущую строку в дереве</ul><p>Данный пример с группировкой по 1 полю</p><p><img src="https://user-images.githubusercontent.com/36256417/81786911-b87ad480-9519-11ea-8e2f-2c30964b3631.png" alt="image" /></p><p>Результат</p><p><img src="https://user-images.githubusercontent.com/36256417/81808568-529e4500-9539-11ea-9523-e273681d3974.png" alt="image" /></p><p> Более подробно про директивы <a href="../tree-output-level-by-condition/">level, top, show_if, hide_if</a></p></article><hr><footer><p><a href="#top" id="back-to-top">Вернуться к началу</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/bizhuka/bizhuka.github.io/tree/master/docs_ru/xtt/00-compare.md" id="edit-this-page">Page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div><div id="disqus_thread"></div></div>
